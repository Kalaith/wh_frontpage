RewriteEngine On

# Set the base path
RewriteBase /

# Route API requests to backend (handle both 'backend' and 'api' folder names)
RewriteCond %{REQUEST_URI} ^/api/
RewriteCond %{DOCUMENT_ROOT}/backend/public/index.php -f
RewriteRule ^api/(.*)$ backend/public/index.php [QSA,L]

RewriteCond %{REQUEST_URI} ^/api/
RewriteCond %{DOCUMENT_ROOT}/api/public/index.php -f
RewriteRule ^api/(.*)$ api/public/index.php [QSA,L]

# Force React routing for specific SPA routes (even if directories exist)
RewriteRule ^(projects|tracker|features|profile)/?$ index.html [L]

# Handle client-side routing for React app (for other routes)
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_URI} !^/backend/
RewriteCond %{REQUEST_URI} !^/api/
RewriteRule . index.html [L]
